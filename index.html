');
        }

        function showSuccess(elementId, message) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.classList.remove('hidden');
        }

        function clearSuccess(elementId) {
            const element = document.getElementById(elementId);
            element.textContent = '';
            element.classList.add('hidden');
        }

        // ===== EVENT LISTENERS =====
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            clearError('loginError');

            const username = document.getElementById('loginUsername').value.trim();
            const password = document.getElementById('loginPassword').value;

            const result = await login(username, password);

            if (result.success) {
                document.getElementById('loginForm').reset();
                showMainApp();
            } else {
                showError('loginError', result.error);
            }
        });

        document.getElementById('registerForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            clearError('registerError');
            clearSuccess('registerSuccess');

            const username = document.getElementById('registerUsername').value.trim();
            const email = document.getElementById('registerEmail').value.trim();
            const password = document.getElementById('registerPassword').value;

            const result = await register(username, email, password);

            if (result.success) {
                document.getElementById('registerForm').reset();
                showSuccess('registerSuccess', 'Konto utworzone! Możesz się teraz zalogować.');
                setTimeout(() => {
                    showLogin();
                }, 2000);
            } else {
                showError('registerError', result.error);
            }
        });

        // Keyboard shortcut for posting (Ctrl+Enter)
        document.getElementById('postContent').addEventListener('keydown', (e) => {
            if (e.ctrlKey && e.key === 'Enter') {
                createPost();
            }
        });

        // ===== INITIALIZATION =====
        window.addEventListener('DOMContentLoaded', () => {
            // Check if user has active session
            if (!checkSession()) {
                showLogin();
            }
        });
    </script>
</body>
</html>